trigger: none
pr: none

parameters:
  - name: publishLocalizationFile
    type: boolean
    default: true


variables:
# Variable group contains the PAT to LOC
- group: OneLocBuildVariables

jobs:
- job: Localization
  pool:
    name: NetCore1ESPool-Svc-Internal
    demands: ImageOverride -equals windows.vs2022preview.amd64
  steps:
  - task: NodeTool@0
    displayName: 'Install Node.js 16.x'
    inputs:
      versionSpec: '16.x'
  - checkout: self
    clean: true
    submodules: true
    fetchTags: false
    fetchDepth: 0
  - script: |
      npm run l10nDevGenerateLocalizationBundle
      npm run l10nDevGenerateXlf
    displayName: Generate xlf files
  - task: OneLocBuild@2
    env:
      SYSTEM_ACCESSTOKEN: $(System.AccessToken)
    inputs:
      locProj: loc/LocProject.json
      outDir: '$(Build.SourcesDirectory)/loc'
      isCreatePrSelected: false
      patVariable: $(dn-bot-ceapex-package-r)
      packageSourceAuth: patAuth
      lclSource: lclFilesfromPackage
      LclPackageId: 'PackageIdFromLOCTeam'
  - task: PublishBuildArtifacts@1
    displayName: Publish Localization Files
    inputs:
      PathtoPublish: '$(Build.SourcesDirectory)/loc'
      PublishLocation: Container
      ArtifactName: Loc
    condition: ${{ parameters.publishLocalizationFile }}

    # TODO import and create PR if needed
